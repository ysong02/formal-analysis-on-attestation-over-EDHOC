## Formal Verification for Remote Attestation over EDHOC

### Threat Model
- Standard EDHOC threat model (weak DH, weak hash etc.)
- Long-term Key (privLTK) may be leaked
- Ephemeral Key (privEK) may be leaked 
- Attestation Key (privAK) may be leaked
- Assumptions 
    - No weakness in the generation of Claims
    - Verifier provisioned with Reference values
    - Verifier provisioned with pubAK
    
### Informal Security Goals

#### Remote Attestation goals
- **Integrity of Evidence**
Ensures that the evidence has not been altered in an unauthorized manner since it was created and transmitted.
In draft-ietf-lake-ra, the Attester digitally signs the evidence.
Digital signature provides the protection against tampering of the evidence.

- **Integrity of Attestation Results**
Ensures that the attestation result has not been altered in an unauthorized manner since it was created and transmitted.
The attestation result is digitally signed by the Verifier.
Digital signature provides the protection against tampering of the attestation result.

- **Freshness of Evidence**
Ensures that the evidence reflects the current state of the Attester, preventing the replayed or outdated evidence.
Draft-ietf-lake-ra guarantees freshness by using a nonce, a random byte string used only once generated by the Verifier and included by the Attester in the evidence.
The nonce is deleted after the verification.

- **Freshness of Attestation Results**
Ensures that the attestation result produced by the Verifier is based on the latest available evidence, preventing the Relying Party from accepting stale attestation result.
Draft-ietf-lake-ra guarantees attestation result freshness through the nonce that the Relying Party generates.
The nonce is forwarded to the Verifier and embedded in the attestation result.
The Relying Party validates this nonce upon reception to ensure attestation result freshness.

#### EDHOC goals
- Authentication of EDHOC Initiator (Attester)
- Authentication of EDHOC Responder (Relying Party)
Ensures that both parties verify each other's identity, preventing impersonation and man-in-the-middle attacks.
Standard EDHOC protocol provides mutual authentication, draft-ietf-lake-ra integrates attestation elements into EDHOC's EAD fields and preserves the standard authentication mechanism.

#### Composition goals 
- Channel binding
Ensures that the attestation is cryptographically bound to the authentication, preventing diversion attacks across different channels.
In draft-ietf-lake-ra, the evidence in EAD_3 serves as input to the derivation of the final transcript hash, which in turn derives the EDHOC session key.
Evidence from a different channel results in a different transcript hash, causing session key derivation to fail.
- Agreement of all Remote Attestation and EDHOC parameters
All parameters are negotiated through the exchanged messages, with attestation-specific parameters conveyed in the EAD fields.

### Protocol Diagram
Click [here](https://drive.google.com/file/d/1RbaLIKyjo614sKNcDc8y-1gNh3to4047/view?usp=sharing) to see the source file of the diagram.
<img width="4708" height="6160" alt="image" src="https://github.com/user-attachments/assets/5a5fa5fb-02c7-4c29-8007-4a767597a049" />
